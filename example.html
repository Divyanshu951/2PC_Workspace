<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Retro Timer</title>
  <style>
    .timer-container {
      position: fixed;
      bottom: 1px;
      left: 1px;
      width: 45px;
      height: 230px;
      background-color: #111; /* Dark container background */
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.6); /* Depth effect */
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden; /* Ensure content doesn't overflow */
      transition: background-color 0.5s ease; /* Smooth transition for flashing */
    }

    .timer {
      font-size: 1.2rem; /* Adjust font size to fit the smaller container */
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #fff;
    }

    .digit, .separator {
      width: 30px;
      height: 40px;
      background-color: #d32f2f; /* Bright red tiles */
      color: #fff; /* White text on red tiles */
      border-radius: 5px; /* Slightly rounded corners */
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      margin: 2px; /* Small margin between digits */
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6); /* Shadow for depth */
      cursor: pointer;
    }

    .separator {
      background-color: transparent;
      color: #d32f2f; /* Red separator */
      font-size: 1rem;
      box-shadow: none;
    }

    .flashing {
      background-color: #4caf50 !important; /* Flash green */
    }
  </style>
</head>
<body>
  <div class="timer-container" id="timer-container">
    <div class="timer" id="timer">
      <div class="digit" id="minute1">0</div>
      <div class="digit" id="minute2">2</div>
      <div class="separator">-</div>
      <div class="digit" id="second1">0</div>
      <div class="digit" id="second2">0</div>
    </div>
  </div>

  <audio id="alarm" src="alarm.wav"></audio>

  <script>
    const minute1 = document.getElementById("minute1");
    const minute2 = document.getElementById("minute2");
    const second1 = document.getElementById("second1");
    const second2 = document.getElementById("second2");
    const timerDiv = document.getElementById("timer");
    const timerContainer = document.getElementById("timer-container"); // Reference to the container
    const alarm = document.getElementById("alarm");

    let totalSeconds = 120; // Initial time (02:00)
    let interval = null;
    let flashingInterval = null; // Variable to store setInterval for flashing

    function updateTimer() {
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;

      minute1.textContent = Math.floor(minutes / 10);
      minute2.textContent = minutes % 10;
      second1.textContent = Math.floor(seconds / 10);
      second2.textContent = seconds % 10;

      if (totalSeconds > 0) {
        totalSeconds--;
      } else {
        clearInterval(interval); // Stop when time reaches 0
        interval = null;
        triggerAlarm(); // Trigger alarm and flashing effect
      }
    }

    function startTimer() {
      if (!interval) {
        interval = setInterval(updateTimer, 1000);
      }
    }

    function resetTimer() {
      clearInterval(interval);
      interval = null;
      totalSeconds = 120; // Reset to 02:00
      updateTimer(); // Immediately update the display
      stopFlashing(); // Remove flashing if it was active
    }

    function triggerAlarm() {
      alarm.play(); // Play the alarm sound
      startFlashing();
      setTimeout(() => {
        stopFlashing(); // Stop flashing after 10 seconds
        resetTimer(); // Reset the timer after 10 seconds
      }, 10000); // 10 seconds timeout for stopping flashing and resetting the timer
    }

    function startFlashing() {
      flashingInterval = setInterval(() => {
        timerContainer.classList.toggle("flashing");
      }, 500); // Toggle flashing every 500ms
      timerContainer.classList.add("flashing");
    }

    function stopFlashing() {
      clearInterval(flashingInterval); // Clear the flashing interval to stop flashing
      timerContainer.classList.remove("flashing"); // Remove the flashing class
    }

    // Event listener for single click (start) and double-click (reset)
    let clickTimeout;
    timerDiv.addEventListener("click", () => {
      if (clickTimeout) {
        clearTimeout(clickTimeout);
        clickTimeout = null;
        resetTimer(); // Double-tap resets the timer
      } else {
        clickTimeout = setTimeout(() => {
          startTimer(); // Single-click starts the timer
          clickTimeout = null;
        }, 300); // Adjust timeout for double-click detection
      }
    });

    // Initialize the display
    updateTimer();
  </script>
</body>
</html>
